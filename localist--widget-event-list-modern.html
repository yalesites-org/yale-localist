{% unless settings.style == 'none' %}

  {% comment %}
  #################################
  START MAKE COLOR/FONT CHANGES HERE
  you can change colors and fonts in this section rather than modifying CSS directly below
  {% endcomment %}

  {% assign link_color = 'hsl(213, 66%, 45%)' %}
  {% assign link_hover = 'hsl(0, 0%, 25%)' %}

  {% assign button_color = 'hsl(213, 66%, 45%)' %}
  {% assign button_hover = 'hsl(0, 0%, 25%)' %}
  {% assign button_font_color = '#fff' %}

  {% assign font_family = '"Mallory",Helvetica,Arial,sans-serif' %}
  {% assign yale_new = '"YaleNew", serif'  %}
  {% assign im_going_text = "I'm Interested" %}
  
  {% assign event_data_bg = 'rgba(0, 54, 107,0.9)' %}


  {% comment %}
  END MAKE COLOR/FONT CHANGES HERE
  #################################
  {% endcomment %}

  <style type="text/css">
    /* container for the widget */
    .localist_widget_container {
      width: 100%;
      background-color: #fff;
      overflow: hidden;
    }

    /* all links within an event item */
    .localist_widget_container li a {
      text-decoration: none;
      color: {{ link_color }};
    }

    /* all hovered links within an event item */
    .localist_widget_container li a:hover,
    .localist_widget_container li a:focus {
      text-decoration: underline;
      color: {{ link_hover }};
    }

    /* container for the list of event items */
    .localist_widget_container ul.lw_event_list {
      list-style: none;
      padding:0 0 2rem;
      max-width: 1344px;
    }

    /* container for each event item */
    .localist_widget_container li.lw_event_item {
      font: normal 1rem/1 {{ font_family }};
      margin: 5px 0;
      border-bottom: 1px solid #ddd;
      overflow: hidden;
    }

    .localist_widget_container .clock {
      border-color: {{ event_data_bg }};
    }

    /* container for event photo */
    .localist_widget_container a.lw_event_item_image {
      display: block;
      float: left;
      overflow: hidden;
      max-width: 35%;
      position:relative;
    }

    /* event photo (makes it center on the image if dimensions grow/shrink) */
    .localist_widget_container a.lw_event_item_image img {
      top: 50%;
      left: 50%;
      position:relative;
      transform: translate(-50%, 0%)
    }

    /* container for non-image content */
    .localist_widget_container div.lw_event_content {
      padding: 1rem 2rem;
      overflow: hidden;
      vertical-align: text-top;
    }

    .localist_widget_container div.lw_event_inner_wrap {
      display: flex;
      flex-flow: row wrap;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }
    
    /* event title */
    .localist_widget_container div.lw_event_item_title {
      font: normal 3rem/1 {{ yale_new }};
      margin-bottom: 0.5rem;
    }

    /* event description */
    .localist_widget_container div.lw_event_item_description {
      font-size: 1rem;
      line-height: 1.2;
      margin-bottom: 1rem;
      max-width: 80%;
    }

    /* container for event meta data */
    .localist_widget_container .lw_event_meta {
      overflow: hidden;
    }
    
    .localist_widget_container .lw_event_meta.lw_event_location {
      display: flex;
      flex-flow: row wrap;
      gap: 1rem;
      justify-content: flex-start;
      align-items: center;
      flex: 1 auto;
      text-transform: uppercase;
      font-size: 1rem;
    }
    
    .localist_widget_container .lw_event_meta.lw_event_rsvp {
      flex: 0 auto;
    }

    /* event location and time shared code */
    .localist_widget_container div.lw_event_item_time {
      font-size: 1rem;
      text-transform: uppercase;
    }

    /* event date */
    .localist_widget_container span.lw_event_item_date {
      font: bold 0.85rem/1 {{ font_family }};
      color: {{event_data_bg}};
      text-transform: uppercase;
    }

    /* event cta */
    .localist_widget_container .action_button a {
      display: block;
      background: {{ button_color }};
      color: {{ button_font_color }};
      line-height: 40px;
      text-decoration: none;
      text-align: center;
      margin-top: 10px;
      max-width: 200px;
      font-weight: bold;
      padding: 0 1rem;
    }

    /* event cta hover */
    .localist_widget_container .action_button a:hover,
    .localist_widget_container .action_button a:focus {
      text-decoration: none;
      background-color: {{ button_hover }};
      color: {{button_font_color}};
    }

    .localist_widget_container .action_button a:visited {
      color: {{ button_font_color }};
    }


    .localist_widget_container .action_button a:hover:visited {
      color: {{ button_font_color }};
    }

      /* all events */
    .localist_widget_container .lw_view_all_cta a {
      display: block;
      text-align: center;
      color: {{ link_color }};
      font: bold 1rem/1 {{ font_family }};
    }

    .localist_widget_container .lw_view_all_cta a:hover,
    .localist_widget_container .lw_view_all_cta a:focus {
      text-decoration: none;
    }
  </style>
{% endunless %}


{% if settings.expand_descriptions %}
  <script type="text/javascript">
    mc_$$ID$$_util = (function() {
      function getEl(el) {
        if('tagName' in el) return el;
        return document.getElementById(el);
      }

      function upTag(el, tag) {
        var e;
        if(e = getEl(el)) {
          while(e) {
            if(e.tagName.toLowerCase() == tag.toLowerCase()) return e;
            e = e.parentNode;
          }
          return null;
        } else {
          return null;
        }
      }

      function hasClass(el, klass) {
        if(!el) return;
        var classes = el.className;
        return (classes.length > 0 && (classes == klass ||
          new RegExp("(^|\\s)" + klass + "(\\s|$)").test(classes)));
      }

      function downClass(el, tag, klass) {
        var e = getEl(el);
        if(!e) return null;
        var els = e.getElementsByTagName(tag);
        var i = 0;
        for(i = 0; i < els.length; i++) {
          e = els[i];
          if(hasClass(e, klass)) return e;
        }
        return null;
      }

      function toggleVisibility(el) {
        var e;
        if(e = getEl(el)) {
          if(e.style.display == 'none') {
            e.style.display = '';
          } else {
            e.style.display = 'none';
          }
        }
      }

      return {
        toggle: function(el) {
          toggleVisibility(downClass(upTag(el, 'li'), 'div', 'lww'));
        }
      };
    })();
  </script>
{% endif %}


{% if current_user %}<!-- logged in -->{% endif %}

<div class="localist_widget_wrapper">
  <div class="localist_widget_container">
    <ul class="lw lw_event_list">
      {% if events == empty %}
        <li class="lw lw_event_item nocontent">
          <div class="lw_event_item_title">{{ site.snippets.widget_nocontent }}</div>
        </li>
      {% else %}
        {% for event in events %}
          {{ event_knowledge_graph_tag }}

          <li class="lw lw_event_item">

            {% if settings.hide_images != true %}
            <a class="lw_event_item_image" href="{{ event.url }}"{% if settings.target_blank %} target="_blank"{% endif %}{% if settings.expand_descriptions %} onclick="mc_$$ID$$_util.toggle(this); return false;"{% endif %}>
              {% photo_for event size:square_300 width:150 height:150 %}
            </a>
            {% endif %}

            <div class="lw_event_content">
              <div class="lw_event_item_title">
                <a href="{{ event.url }}"{% if settings.target_blank %} target="_blank"{% endif %}{% if settings.expand_descriptions %} onclick="mc_$$ID$$_util.toggle(this); return false;"{% endif %}>{% unless event.status == 'live' %}{{ site.snippets.event_status[event.status] }}: {% endunless %}{{ event.name }}</a>
              </div>

              {% if settings.expand_descriptions %}<div class=lww style="display:none">{% endif %}

              {% unless settings.hide_descriptions %}
                <div class="lw_event_item_description">
                  {% item_description event %}
                  {% if settings.show_keywords %}
                    <br/>{{ event.keywords | join:", " }}
                  {% endif %}
                </div>
              {% endunless %}

              {% if settings.expand_descriptions %}</div>{% endif %}

              <div class="lw_event_inner_wrap">
                <span class="lw_event_item_date">
                  {% event_time event order:"date" date_format:settings.date_format time_format:settings.time_format short_time_format:settings.short_time_format %}
  
                  {% if show_date_ranges and event.has_many_future_instances %}
                    - {{ event.last_instance.starts_at | date:settings.date_format }}
                  {% endif %}
                </span>

                {% if settings.show_times %}
                  {% if event.start_time %}
                    <div class="lw_event_item_time">
                      {% event_time event order:"time" time_format:settings.time_format short_time_format:settings.short_time_format %}
                    </div>
                  {% endif %}
                {% endif %}
                <div class="lw_event_meta lw_event_location">
                  {% if event.event_type == 'event' %}
                    {% if event.place != empty and event.location_name != blank %}
                      <div class="lw_event_item_location">
                        {% if event.place %}
                          <a href="{{ event.place.url }}"{% if settings.target_blank %} target="_blank"{% endif %}>{{ event.place.visible_name }}</a>
                        {% else %}
                          <a href="{{ event.url }}"{% if settings.target_blank %} target="_blank"{% endif %}>{{ event.location_name }}</a>
                        {% endif %}
                      </div>
                    {% endif %}
                  {% endif %}
  
                  &nbsp;
                </div>

                {% if settings.expand_descriptions %}<div class=lww style="display:none">{% endif %}
                <div class="lw_event_meta lw_event_rsvp">
                  <div class="action_button">
                    <a href="{{ event.url }}" aria-label="View details about {{ event.name }}" {% if settings.target_blank %} target="_blank"{% endif %}>{{ im_going_text }}</a>
                  </div>
                </div>
                {% if settings.expand_descriptions %}</div>{% endif %}
              </div>
            </div>
          </li>
        {% endfor %}

      {% endif %}
      {% if settings.show_view_all_cta %}
        <p class="lw lw_view_all_cta"><a href="{% relative_calendar_url %}">View all events...</a></p>
      {% endif %}        
    </ul>
  </div>
</div>
